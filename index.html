<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Aumento</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { background-color: #0f172a; color: white; -webkit-tap-highlight-color: transparent; overflow-x: hidden; }
        .glass { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .progress-ring { transition: stroke-dashoffset 0.5s ease; transform: rotate(-90deg); transform-origin: 50% 50%; }
        .btn-active:active { transform: scale(0.95); transition: 0.1s; }
        .page { display: none; }
        .page.active { display: block; }
        .viewport-overlay { box-shadow: 0 0 0 9999px rgba(15, 23, 42, 0.75); border: 2px solid #10b981; }
    </style>
</head>
<body class="font-sans antialiased pb-24 text-white">

    <div id="onboarding-screen" class="hidden fixed inset-0 z-[200] bg-slate-950 flex flex-col p-8 justify-center items-center text-center">
        <div class="w-full max-w-sm space-y-8">
            <h1 class="text-4xl font-black text-emerald-400 italic tracking-tighter">AUMENTO</h1>
            <div class="glass p-8 rounded-[3rem] space-y-6">
                <div class="space-y-4 text-left">
                    <input id="setup-user" type="text" class="w-full bg-white/5 border border-white/10 p-4 rounded-2xl text-white outline-none" placeholder="Adafruit Username">
                    <input id="setup-key" type="password" class="w-full bg-white/5 border border-white/10 p-4 rounded-2xl text-white outline-none" placeholder="Adafruit IO Key">
                </div>
                <button onclick="saveOnboarding()" class="w-full bg-emerald-500 text-slate-950 font-black py-5 rounded-3xl btn-active uppercase italic">Initialize Cloud</button>
            </div>
        </div>
    </div>

    <header class="p-6 pt-12 flex justify-between items-center">
        <div>
            <h1 class="text-3xl font-black tracking-tight text-emerald-400 italic">AUMENTO</h1>
            <p id="today-date" class="text-slate-400 text-sm italic uppercase tracking-widest font-bold"></p>
        </div>
        <button onclick="toggleSettings()" class="p-2 rounded-full glass btn-active">
            <i data-lucide="settings" class="w-6 h-6"></i>
        </button>
    </header>

    <main id="dashboard-page" class="page active px-6 space-y-8 text-center">
        <div class="relative flex items-center justify-center py-4">
            <svg class="w-56 h-56">
                <circle class="text-slate-800" stroke-width="12" stroke="currentColor" fill="transparent" r="90" cx="112" cy="112" />
                <circle id="calorie-ring" class="text-emerald-500 progress-ring" stroke-width="12" stroke-dasharray="565" stroke-dashoffset="565" stroke-linecap="round" stroke="currentColor" fill="transparent" r="90" cx="112" cy="112" />
            </svg>
            <div class="absolute">
                <span class="block text-5xl font-black tracking-tighter" id="current-cal">0</span>
                <span class="text-[10px] text-slate-500 font-black uppercase tracking-[0.2em]" id="goal-display">/ 2800 KCAL</span>
            </div>
        </div>

        <div class="grid grid-cols-2 gap-4 text-left">
            <div class="glass p-5 rounded-[2rem]">
                <div class="flex items-center gap-2 mb-1 text-blue-400">
                    <i data-lucide="droplet" class="w-4 h-4"></i>
                    <span class="text-[10px] font-black uppercase tracking-widest">Hydration</span>
                </div>
                <p class="text-2xl font-black"><span id="water-count">0</span><span class="text-sm text-slate-500"> / 4</span></p>
                <p class="text-[10px] text-slate-500" id="bottle-size-label">32oz bottles</p>
            </div>
            <div class="glass p-5 rounded-[2rem]">
                <div class="flex items-center gap-2 mb-1 text-orange-400">
                    <i data-lucide="zap" class="w-4 h-4"></i>
                    <span class="text-[10px] font-black uppercase tracking-widest">Protein</span>
                </div>
                <p class="text-2xl font-black"><span id="protein-count">0</span><span class="text-sm text-slate-500"> / 100g</span></p>
                <p class="text-[10px] text-slate-500">Daily Goal</p>
            </div>
        </div>

        <div class="space-y-4">
            <button onclick="openLogChoice()" class="w-full bg-emerald-500 text-slate-950 font-black text-lg py-5 rounded-3xl btn-active uppercase italic tracking-tighter shadow-lg shadow-emerald-500/20">Log Real Meal</button>
            <div class="grid grid-cols-2 gap-4">
                <button onclick="manualLog('shake')" class="glass py-5 rounded-3xl flex flex-col items-center gap-2 btn-active">
                    <i data-lucide="cup-soda" class="w-6 h-6 text-orange-400"></i>
                    <span class="text-[10px] font-black uppercase tracking-widest">Log Shake</span>
                </button>
                <button onclick="confirmWater()" class="glass py-5 rounded-3xl flex flex-col items-center gap-2 btn-active">
                    <i data-lucide="droplets" class="w-6 h-6 text-blue-400"></i>
                    <span class="text-[10px] font-black uppercase tracking-widest">Log Water</span>
                </button>
            </div>
            <button onclick="logWeight()" class="w-full glass py-5 rounded-3xl flex items-center justify-center gap-3 btn-active border-emerald-500/10">
                <i data-lucide="scale" class="w-5 h-5 text-emerald-400"></i>
                <span class="text-[10px] font-black uppercase tracking-widest">Log Body Weight (lbs)</span>
            </button>
        </div>
    </main>

    <main id="progress-page" class="page px-6 space-y-6">
    <div class="flex justify-between items-center">
        <h2 class="text-xl font-black italic text-emerald-400 uppercase tracking-widest">Growth History</h2>
        <button onclick="loadHistory()" class="p-2 glass rounded-full text-emerald-400 btn-active">
            <i data-lucide="refresh-cw" class="w-4 h-4"></i>
        </button>
    </div>
    
    <div id="history-container" class="space-y-6 pb-12">
        <p class="text-slate-500 text-sm italic text-center py-10">Tap refresh to load cloud data...</p>
    </div>
</main>

    <nav class="fixed bottom-0 left-0 right-0 p-6 z-40">
        <div class="glass max-w-xs mx-auto rounded-full flex justify-around p-2 border-white/20">
            <button onclick="showPage('dashboard')" id="nav-dashboard" class="p-3 rounded-full bg-emerald-500 text-slate-950">
                <i data-lucide="home" class="w-6 h-6"></i>
            </button>
            <button onclick="showPage('progress')" id="nav-progress" class="p-3 rounded-full text-slate-400">
                <i data-lucide="bar-chart-2" class="w-6 h-6"></i>
            </button>
        </div>
    </nav>

    <div id="settings-modal" class="hidden fixed inset-0 z-[150] flex items-center justify-center bg-slate-950/95 p-6">
        <div class="glass w-full max-w-sm p-8 rounded-[3rem] space-y-6 text-center">
            <h2 class="text-2xl font-black text-emerald-400 uppercase italic">Settings</h2>
            <div class="space-y-4 text-left">
                <label class="text-[10px] font-bold text-slate-500 uppercase ml-2">Daily Calorie Goal</label>
                <input id="set-goal" type="number" class="w-full bg-white/5 p-4 rounded-2xl text-white outline-none border border-white/10" placeholder="2800">
                <label class="text-[10px] font-bold text-slate-500 uppercase ml-2">Bottle Size (oz)</label>
                <input id="set-bottle" type="number" class="w-full bg-white/5 p-4 rounded-2xl text-white outline-none border border-white/10" placeholder="32">
            </div>
            <button onclick="saveSettings()" class="w-full bg-white text-black font-black py-4 rounded-2xl btn-active uppercase">Update Settings</button>
            <button onclick="resetDaily()" class="w-full text-red-500 font-bold py-2 uppercase text-[10px] tracking-widest">Reset Today</button>
            <button onclick="toggleSettings()" class="w-full text-slate-500 font-bold py-2 uppercase text-[10px] tracking-widest">Close</button>
        </div>
    </div>

    <div id="log-choice-modal" class="hidden fixed inset-0 z-[60] flex items-end p-6 bg-slate-950/80 backdrop-blur-sm">
        <div class="glass w-full rounded-[3rem] p-8 space-y-4">
            <button onclick="startCamera()" class="w-full bg-white text-black font-black py-5 rounded-2xl flex items-center justify-center gap-3 btn-active uppercase"><i data-lucide="camera"></i> AI Vision Scan</button>
            <button onclick="openManualEntry()" class="w-full bg-slate-800 text-white font-black py-5 rounded-2xl flex items-center justify-center gap-3 btn-active uppercase"><i data-lucide="edit-3"></i> Manual Entry</button>
            <button onclick="closeModals()" class="w-full py-4 text-slate-500 font-bold uppercase text-[10px]">Cancel</button>
        </div>
    </div>

    <div id="manual-entry-modal" class="hidden fixed inset-0 z-[70] bg-slate-950 flex items-center justify-center p-6">
        <div class="glass w-full max-w-sm p-8 rounded-[3rem] space-y-6">
            <h2 class="text-2xl font-black text-emerald-400 uppercase italic text-center">New Log</h2>
            <input id="food-name" type="text" class="w-full bg-white/5 p-4 rounded-2xl text-white outline-none border border-white/10" placeholder="Food Name">
            <div class="grid grid-cols-2 gap-4">
                <input id="food-cal" type="number" class="w-full bg-white/5 p-4 rounded-2xl text-white outline-none border border-white/10" placeholder="Cals">
                <input id="food-prot" type="number" class="w-full bg-white/5 p-4 rounded-2xl text-white outline-none border border-white/10" placeholder="Prot">
            </div>
            <button onclick="submitManualEntry()" class="w-full bg-emerald-500 text-slate-950 font-black py-5 rounded-3xl btn-active uppercase italic">Save Log</button>
            <button onclick="closeModals()" class="w-full text-slate-500 font-bold py-2 uppercase text-xs text-center">Cancel</button>
        </div>
    </div>

    <div id="camera-viewport" class="hidden fixed inset-0 z-[100] bg-black">
        <video id="video" class="w-full h-full object-cover" autoplay playsinline></video>
        <canvas id="canvas" class="hidden"></canvas>
        <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
            <div class="w-72 h-72 viewport-overlay rounded-[2.5rem]"></div>
        </div>
        <div class="absolute bottom-12 left-0 right-0 flex justify-around px-10">
            <button onclick="stopCamera()" class="glass p-4 rounded-full"><i data-lucide="x"></i></button>
            <button onclick="captureImage()" class="w-20 h-20 bg-white rounded-full border-4 border-emerald-500 shadow-2xl"></button>
            <div class="w-12 h-12"></div>
        </div>
    </div>

   <script src="app.js"></script>
</body>
</html>
